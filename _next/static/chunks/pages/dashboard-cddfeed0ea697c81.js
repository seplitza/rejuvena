(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{528:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(6401)}])},6401:function(e,t,r){"use strict";r.r(t);var s=r(5893),n=r(7294),a=r(1163),l=r(9133),i=r(3031),u=r(803),c=r(8256),o=r(7963),d=r(5635);t.default=()=>{let e=(0,a.useRouter)(),t=(0,l.T)(),{user:r,isAuthenticated:p}=(0,l.C)(e=>e.auth),[m,x]=(0,n.useState)([]);return((0,n.useEffect)(()=>{p||e.push("/auth/login")},[p,e]),(0,n.useEffect)(()=>{let e=async()=>{try{let e=await u.WY.get(c.fI);e.payments&&x(e.payments.slice(0,5))}catch(e){console.error("Failed to load payments:",e)}};p&&(console.log("\uD83D\uDD0D Dashboard user data:",{isPremium:null==r?void 0:r.isPremium,premiumEndDate:null==r?void 0:r.premiumEndDate,premiumEndDateType:typeof(null==r?void 0:r.premiumEndDate),fullUser:r}),e())},[p,r]),p)?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Личный кабинет"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(o.Z,{}),(0,s.jsx)("button",{onClick:()=>{p&&(t((0,i.kS)()),u.VH.remove()),e.push("/auth/login")},className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:p?"Выйти":"Войти"})]})]})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:["Добро пожаловать, ",(null==r?void 0:r.firstName)||"Гость","!"]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Email: ",(null==r?void 0:r.email)||"Не указан"]})]}),(null==r?void 0:r.isPremium)?(0,s.jsx)("div",{className:"mb-6 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg shadow-lg p-6 text-white",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-2",children:"✨ Премиум доступ активен"}),(0,s.jsxs)("p",{className:"text-purple-100",children:["Активен до: ",(null==r?void 0:r.premiumEndDate)?new Date(r.premiumEndDate).toLocaleDateString("ru-RU"):"неизвестно"]}),(null==r?void 0:r.premiumEndDate)&&(0,s.jsxs)("p",{className:"text-purple-100 mt-1",children:["Осталось дней: ",Math.max(0,Math.ceil((new Date(r.premiumEndDate).getTime()-new Date().getTime())/864e5))]}),(0,s.jsx)("p",{className:"text-purple-100 mt-1",children:"\uD83C\uDFAF Полный доступ ко всем упражнениям и материалам"})]}),(0,s.jsx)("div",{className:"text-6xl",children:"\uD83D\uDC51"})]})}):(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(d.Z,{})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/courses"),children:[(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCDA"}),(0,s.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Мои курсы"})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/exercises"),children:[(0,s.jsx)("span",{className:"text-3xl",children:"\uD83C\uDFCB️"}),(0,s.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Упражнения"})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/photo-diary"),children:[(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCF8"}),(0,s.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Фото-дневник"})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/profile/settings"),children:[(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDC64"}),(0,s.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Профиль"})]})]})}),p&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Последняя активность"}),0===m.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"text-gray-400 text-5xl mb-2",children:"\uD83D\uDCED"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Активности пока нет"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Начните с выбора курса!"})]}):(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>{var t,r;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"text-2xl",children:"succeeded"===e.status?"✅":"processing"===e.status?"⏳":"failed"===e.status?"❌":"⏸️"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-800",children:"succeeded"===e.status?"Оплата принята":"processing"===e.status?"Обработка оплаты":"failed"===e.status?"Оплата не прошла":"Ожидание оплаты"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:(null===(t=e.metadata)||void 0===t?void 0:t.planType)==="premium"?"Премиум доступ на ".concat(e.metadata.duration," дней"):(null===(r=e.metadata)||void 0===r?void 0:r.exerciseName)?"Покупка: ".concat(e.metadata.exerciseName):"Покупка"})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-bold text-gray-800",children:[e.amount," ₽"]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("ru-RU")})]})]},e.id)})})]})]})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})})}},8697:function(e,t,r){"use strict";r.d(t,{P1:function(){return a}});var s="NOT_FOUND",n=function(e,t){return e===t},a=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return function(){for(var t,s=arguments.length,n=Array(s),a=0;a<s;a++)n[a]=arguments[a];var l=0,i={memoizeOptions:void 0},u=n.pop();if("object"==typeof u&&(i=u,u=n.pop()),"function"!=typeof u)throw Error("createSelector expects an output function after the inputs, but received: ["+typeof u+"]");var c=i.memoizeOptions,o=void 0===c?r:c,d=Array.isArray(o)?o:[o],p=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e}))throw Error("createSelector expects all input-selectors to be functions, but received the following types: ["+t.map(function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e}).join(", ")+"]");return t}(n),m=e.apply(void 0,[function(){return l++,u.apply(null,arguments)}].concat(d)),x=e(function(){for(var e=[],r=p.length,s=0;s<r;s++)e.push(p[s].apply(null,arguments));return t=m.apply(null,e)});return Object.assign(x,{resultFunc:u,memoizedResultFunc:m,dependencies:p,lastResult:function(){return t},recomputations:function(){return l},resetRecomputations:function(){return l=0}}),x}}(function(e,t){var r,a,l="object"==typeof t?t:{equalityCheck:t},i=l.equalityCheck,u=l.maxSize,c=void 0===u?1:u,o=l.resultEqualityCheck,d=(r=void 0===i?n:i,function(e,t){if(null===e||null===t||e.length!==t.length)return!1;for(var s=e.length,n=0;n<s;n++)if(!r(e[n],t[n]))return!1;return!0}),p=1===c?{get:function(e){return a&&d(a.key,e)?a.value:s},put:function(e,t){a={key:e,value:t}},getEntries:function(){return a?[a]:[]},clear:function(){a=void 0}}:function(e,t){var r=[];function n(e){var n=r.findIndex(function(r){return t(e,r.key)});if(n>-1){var a=r[n];return n>0&&(r.splice(n,1),r.unshift(a)),a.value}return s}return{get:n,put:function(t,a){n(t)===s&&(r.unshift({key:t,value:a}),r.length>e&&r.pop())},getEntries:function(){return r},clear:function(){r=[]}}}(c,d);function m(){var t=p.get(arguments);if(t===s){if(t=e.apply(null,arguments),o){var r=p.getEntries().find(function(e){return o(e.value,t)});r&&(t=r.value)}p.put(arguments,t)}return t}return m.clearCache=function(){return p.clear()},m})}},function(e){e.O(0,[646,888,774,179],function(){return e(e.s=528)}),_N_E=e.O()}]);