(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{8101:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/exercises",function(){return r(3102)}])},3102:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var s=r(5893),l=r(7294),i=r(1163),a=r(3224),n=r(4675),c=r(1807),o=r(4100),d=r(5871);function x(){let e=(0,i.useRouter)(),[t,r]=(0,l.useState)([]),[x,p]=(0,l.useState)(!0),[u,h]=(0,l.useState)(null),[g,m]=(0,l.useState)({}),[b,w]=(0,l.useState)({}),[f,v]=(0,l.useState)(null),[j,N]=(0,l.useState)(!1),[y,k]=(0,l.useState)(null),[C,S]=(0,l.useState)(!1),[_,E]=(0,l.useState)("all");(0,l.useEffect)(()=>{S(!0)},[]),(0,l.useEffect)(()=>{(async()=>{try{p(!0);let e=await fetch("".concat(d.T,"/api/exercises/public"));if(!e.ok)throw Error("Failed to load exercises: ".concat(e.statusText));let t=(await e.json()).map(e=>({id:e._id,exerciseName:e.title,marathonExerciseName:e.duration||"",exerciseDescription:e.content||e.description||"",blockExercise:!1,order:e.order,exerciseContents:e.carouselMedia.map(e=>({id:e.url,type:e.type,contentPath:e.url,order:e.order,isActive:!0,videoServer:""})),tags:e.tags.map(e=>e.name),category:e.category||"Общие"}));r(t),h(null)}catch(e){console.error("Error loading exercises:",e),h(e instanceof Error?e.message:"Failed to load exercises")}finally{p(!1)}})()},[]);let T=e=>{m(t=>({...t,[e]:!t[e]}))},F=(e,t)=>{w(e=>({...e,[t]:!e[t]}))},O=e=>{let t=(0,o.Sw)(e.tags||[]),r=(0,o.qI)(e.id);t.isFree||r?v(e):(k(e),N(!0))},D=()=>{N(!1),k(null)},q=e=>{let t=(0,o.Sw)(e.tags||[]);return t.isFree?1:"basic"===t.priceType?2:"pro"===t.priceType?3:4},P=[...t].sort((e,t)=>{let r=q(e),s=q(t);return r!==s?r-s:e.order-t.order}),z=P.reduce((e,t)=>{let r=t.category||"Общие";return e[r]||(e[r]=[]),e[r].push(t),e},{}),B=Object.keys(z),I="all"===_?P:z[_]||[];return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50",children:[(0,s.jsx)("header",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-3 py-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors flex-shrink-0","aria-label":"Назад",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsx)("h1",{className:"text-xl font-bold flex-1 text-center",children:"Все упражнения"}),(0,s.jsx)("div",{className:"w-10"})]})})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:x?(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Загрузка упражнений..."})]}):u?(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"text-red-500 text-5xl mb-4",children:"⚠️"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Ошибка загрузки"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:u}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Попробовать снова"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 bg-white rounded-2xl shadow-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[(0,s.jsxs)("button",{onClick:()=>E("all"),className:"px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors ".concat("all"===_?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Все (",P.length,")"]}),B.map(e=>(0,s.jsxs)("button",{onClick:()=>E(e),className:"px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors ".concat(_===e?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e," (",z[e].length,")"]},e))]})}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-4",children:(0,s.jsx)("h2",{className:"text-xl font-bold",children:"all"===_?"Все упражнения (".concat(P.length,")"):"".concat(_," (").concat(I.length,")")})}),(0,s.jsx)("div",{className:"px-0 sm:px-6 pb-4 space-y-2",children:0===I.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Упражнения не найдены"}):I.map((e,t)=>{let r="exercise-".concat(e.id||t),l=g[r]||!1,i=b[r]||!1,n=(0,o.Sw)(e.tags||[]),d=(0,o.qI)(e.id),x=!n.isFree&&!d,p=(0,o.ns)(n);return(0,s.jsxs)("div",{className:"relative",children:[p&&(0,s.jsx)("div",{className:"px-4 pt-3 pb-0",children:(0,s.jsx)("span",{className:"inline-block text-xs font-bold px-3 py-1 rounded-full ".concat(n.isFree?"bg-green-100 text-green-700":"pro"===n.priceType?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"),children:p})}),(0,s.jsx)(a.Z,{exercise:e,uniqueId:r,isActive:l,isDone:i,isChanging:!1,onToggle:()=>T(r),onCheck:()=>F(e,r),onDetailClick:()=>O(e)}),e.exerciseDescription&&(0,s.jsx)("div",{className:"px-4 pb-3 text-sm text-gray-600 whitespace-pre-line",style:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!e)return"";let r=e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").trim().split("\n").filter(e=>e.trim()).slice(0,t).join("\n"),s=50*t;return r.length>s?r.substring(0,s).trim()+"...":r}(e.exerciseDescription,4)}),x&&(0,s.jsx)("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-2",children:(0,s.jsx)("div",{className:"bg-white rounded-full p-2 shadow-lg",children:(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})}),C&&y&&(0,s.jsx)(c.Z,{isOpen:j,onClose:D,price:(0,o.Sw)(y.tags||[]).price,exerciseName:y.exerciseName,isPro:"pro"===(0,o.Sw)(y.tags||[]).priceType})]},e.id||t)})})]})]})}),C&&f&&(0,s.jsx)(n.Z,{exercise:f,isOpen:!!f,onClose:()=>v(null),onCheckboxChange:()=>{let e="exercise-".concat(f.id);F(f,e)},isDone:b["exercise-".concat(f.id)]||!1})]})}}},function(e){e.O(0,[675,441,593,888,774,179],function(){return e(e.s=8101)}),_N_E=e.O()}]);