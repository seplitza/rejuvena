(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{6097:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/courses/[courseId]/start",function(){return t(6381)}])},440:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var n=t(5893);t(7294);var a=t(1163),o=t(9133),s=t(5689);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r?e>=200?5:e>=150?4:e>=100?3:e>=50?2:e>=1?1:0:e>=100?3:e>=50?2:e>=1?1:0},i=e=>{let{rating:r,maxStars:t=5}=e;return(0,n.jsx)("div",{className:"flex items-center justify-center space-x-0.5",children:Array.from({length:t}).map((e,t)=>{let a=t+1;return(0,n.jsx)("svg",{className:"w-3 h-3 ".concat(a<=r?"text-yellow-400 fill-current":"text-gray-300"),viewBox:"0 0 20 20",children:(0,n.jsx)("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"})},a)})})};function c(e){let{marathonId:r,currentDayNumber:t}=e,c=(0,a.useRouter)(),d=(0,o.C)(s.h6),u=(null==d?void 0:d.marathonDays)||[],h=(null==d?void 0:d.greatExtensionDays)||[];console.log("\uD83D\uDCCB DaysList - Current day number:",t),console.log("\uD83D\uDCCB DaysList - Marathon days:",u.map(e=>({id:e.id,day:e.day,progress:e.progress}))),console.log("\uD83D\uDCCB DaysList - Practice days:",h.map(e=>({id:e.id,day:e.day,progress:e.progress})));let m=e=>{c.push("/marathons/".concat(r,"/day/").concat(e))};return 0==[...u,...h].length?null:(0,n.jsxs)("div",{className:"mt-8 bg-white rounded-2xl shadow-lg p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Пройденные дни"}),(0,n.jsx)("button",{onClick:()=>c.push("/marathons/".concat(r,"/start")),className:"px-4 py-2 text-white font-semibold rounded-lg transition-all shadow-md hover:shadow-lg",style:{backgroundImage:"linear-gradient(to right, var(--color-primary), var(--color-secondary))"},onMouseEnter:e=>{e.currentTarget.style.opacity="0.9"},onMouseLeave:e=>{e.currentTarget.style.opacity="1"},children:"СТАРТ"})]}),u.length>0&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h4",{className:"text-sm font-semibold mb-3",style:{color:"var(--color-primary)"},children:"Обучение"}),(0,n.jsx)("div",{className:"grid grid-cols-7 gap-2",children:u.map(e=>{let r=e.day===t,a=l(e.progress||0,!1);return(0,n.jsxs)("button",{onClick:()=>m(e.day),disabled:e.isLocked,className:"\n                    relative p-3 rounded-lg border-2 transition-all\n                    ".concat(e.isLocked?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-200 hover:shadow-md cursor-pointer","\n                  "),style:r?{borderColor:"var(--color-primary)",backgroundColor:"var(--color-primary-light, rgba(147, 51, 234, 0.1))"}:{},onMouseEnter:t=>{e.isLocked||r||(t.currentTarget.style.borderColor="var(--color-primary-hover, rgba(147, 51, 234, 0.5))")},onMouseLeave:t=>{e.isLocked||r||(t.currentTarget.style.borderColor="")},children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1",style:r?{color:"var(--color-primary)"}:{color:"#4B5563"},children:"День"}),(0,n.jsx)("div",{className:"text-lg font-bold",style:r?{color:"var(--color-primary)"}:{color:"#1F2937"},children:e.day})]}),a>0&&(0,n.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:(0,n.jsx)(i,{rating:a,maxStars:3})}),e.isLocked&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})]},e.id)})})]}),h.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-semibold text-orange-600 mb-3",children:"Практика"}),(0,n.jsx)("div",{className:"grid grid-cols-7 gap-2",children:h.map(e=>{let r=e.day===t,a=l(e.progress||0,!0);return(0,n.jsxs)("button",{onClick:()=>m(e.day),disabled:e.isLocked,className:"\n                    relative p-3 rounded-lg border-2 transition-all\n                    ".concat(r?"border-orange-500 bg-orange-50":e.isLocked?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-200 hover:border-orange-300 hover:shadow-md cursor-pointer","\n                  "),children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1 ".concat(r?"text-orange-700":"text-gray-600"),children:"День"}),(0,n.jsx)("div",{className:"text-lg font-bold ".concat(r?"text-orange-700":"text-gray-800"),children:e.day})]}),a>0&&(0,n.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:(0,n.jsx)(i,{rating:a,maxStars:5})}),e.isLocked&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})]},e.id)})})]})]})}},6381:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return f}});var n=t(5893),a=t(7294),o=t(1163),s=t(9133),l=t(5689),i=t(7796),c=t(7369),d=t(7526),u=t(440),h=t(5675),m=t.n(h);let p=e=>{let{htmlContent:r}=e,t=Array.from(new DOMParser().parseFromString(r,"text/html").querySelectorAll("li"));return 0===t.length?(0,n.jsx)("div",{className:"prose prose-purple max-w-none",dangerouslySetInnerHTML:{__html:r}}):(0,n.jsx)("div",{className:"space-y-2",children:t.map((e,r)=>(0,n.jsx)("div",{className:"p-4 rounded-lg ".concat(r%2==0?"bg-white":"bg-gray-50"),children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"text-purple-600 font-bold mr-3 mt-0.5",children:"•"}),(0,n.jsx)("div",{className:"flex-1 text-gray-700",dangerouslySetInnerHTML:{__html:e.innerHTML}})]})},r))})};function f(){var e,r,t,h,f;let x=(0,o.useRouter)(),{courseId:g}=x.query,v=(0,s.T)(),y=(0,s.C)(l.h6),b=(0,s.C)(i.sy),[j,N]=(0,a.useState)(!0),[w,C]=(0,a.useState)(!1),[k,D]=(0,a.useState)(!1),P=b.find(e=>e.id===g||e.wpMarathonId===g),L=(null==P?void 0:P.id)||g,M=(null==y?void 0:null===(e=y.welcomeMessage)||void 0===e?void 0:e.welcomeMessage)||"",E=(null==y?void 0:null===(r=y.rule)||void 0===r?void 0:r.rule)||(null==y?void 0:null===(h=y.marathonDays)||void 0===h?void 0:null===(t=h[0])||void 0===t?void 0:t.description)||"",I=(null==y?void 0:y.marathonDays)||[],_=I[I.length-1],T=y&&y.marathonId===L,S=T?y:null;(0,a.useEffect)(()=>{L&&!T&&(console.log("\uD83D\uDCDA Loading marathon data for order ID:",L),v((0,c.JL)({marathonId:L,dayId:"current"})))},[L,T,v]),(0,a.useEffect)(()=>{if(S){let e=!0===S.isAcceptCourseTerm;console.log("\uD83D\uDCCB Marathon data loaded, isAcceptCourseTerm:",e),C(e),L&&P&&e!==P.isAcceptCourseTerm&&v((0,d.eN)({courseId:L,status:e}))}},[S,L,P,v]);let A=async()=>{if(L&&!k){if(!w){alert("Пожалуйста, примите правила курса для продолжения.");return}try{D(!0);let e=null==_?void 0:_.id,r=(null==_?void 0:_.day)||1;e?(console.log("\uD83D\uDCCD Navigating to day",r,"with ID:",e),x.push("/courses/".concat(g,"/day/").concat(e))):(console.log('⚠️ No day ID found, navigating to "current"'),x.push("/courses/".concat(g,"/day/current")))}catch(e){console.error("❌ Failed to navigate:",e),alert("Произошла ошибка. Попробуйте еще раз.")}finally{D(!1)}}},R=async e=>{if(!k)try{D(!0),C(e),v((0,d.fp)({courseId:L,status:e})),console.log(e?"✅ Rules accepted":"❌ Rules rejected","for marathon:",L),await new Promise(e=>setTimeout(e,500))}catch(r){console.error("❌ Failed to update rules acceptance:",r),C(!e),alert("Не удалось сохранить изменения. Попробуйте еще раз.")}finally{D(!1)}};return P?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50",children:[(0,n.jsx)("header",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("button",{onClick:()=>x.push("/courses"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Назад",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),P.imagePath&&(0,n.jsx)("div",{className:"relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0 bg-white/10",children:(0,n.jsx)(m(),{src:P.imagePath,alt:P.title,fill:!0,className:"object-cover"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h1",{className:"text-lg font-bold",children:P.title}),P.subTitle&&(0,n.jsx)("p",{className:"text-sm text-white/80",children:P.subTitle})]})]})})}),(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[M&&(0,n.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:(0,n.jsx)("div",{className:"prose prose-purple max-w-none",dangerouslySetInnerHTML:{__html:M}})}),(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,n.jsxs)("button",{onClick:()=>N(!j),className:"w-full px-6 py-4 flex items-center justify-between bg-gradient-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 transition-colors",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-purple-900",children:"Правила курса"}),(0,n.jsx)("svg",{className:"w-6 h-6 text-purple-600 transition-transform ".concat(j?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j&&(0,n.jsxs)("div",{className:"p-6",children:[E?(0,n.jsx)(p,{htmlContent:E}):(0,n.jsxs)("div",{className:"text-gray-600 space-y-2",children:[(0,n.jsxs)("p",{className:"mb-4",children:["\uD83D\uDCCB ",(0,n.jsx)("strong",{children:"Основные правила:"})]}),["Выполняйте упражнения ежедневно в течение 14 дней","Следуйте видеоинструкциям для правильной техники","Делайте фото до/после для отслеживания прогресса","Отмечайте выполненные упражнения галочками","Набирайте звезды за качественное выполнение"].map((e,r)=>(0,n.jsx)("div",{className:"p-4 rounded-lg ".concat(r%2==0?"bg-white":"bg-gray-50"),children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"text-purple-600 font-bold mr-3",children:"•"}),(0,n.jsx)("span",{className:"flex-1",children:e})]})},r))]}),(0,n.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,n.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer",children:[(0,n.jsx)("input",{type:"checkbox",checked:w,onChange:e=>R(e.target.checked),disabled:k,className:"mt-1 w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500 disabled:opacity-50"}),(0,n.jsx)("span",{className:"text-gray-700",children:"Я ознакомился(ась) с правилами курса и принимаю условия"})]}),(0,n.jsx)("button",{onClick:A,disabled:!w||k,className:"\n                    mt-4 w-full py-3 px-6 rounded-lg font-semibold text-white transition-all\n                    ".concat(w&&!k?"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 shadow-lg":"bg-gray-300 cursor-not-allowed","\n                  "),children:k?"Отправка...":"Начать курс"})]})]})]}),L&&I.length>0&&(0,n.jsx)(u.Z,{marathonId:L,currentDayNumber:(null===(f=I[0])||void 0===f?void 0:f.day)||1})]})]}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-50 to-purple-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Загрузка курса..."})]})})}},7796:function(e,r,t){"use strict";t.d(r,{JB:function(){return p},Kh:function(){return h},LJ:function(){return m},aJ:function(){return c},gi:function(){return f},h3:function(){return v},ks:function(){return i},sy:function(){return s},z5:function(){return x}});var n=t(8697);let a=e=>e.courses,o=(0,n.P1)([a],e=>e.myOrders),s=o,l=(0,n.P1)([o],e=>e.filter(e=>"Approved"===e.orderStatus||"Active"===e.status||!0===e.isPurchased)),i=(0,n.P1)([a],e=>e.loadingOrders);(0,n.P1)([a],e=>e.ordersError);let c=(0,n.P1)([a],e=>e.activatingOrderId),d=(0,n.P1)([a],e=>e.availableCourses),u=(0,n.P1)([a],e=>e.demoCourses);(0,n.P1)([d,u],(e,r)=>[...e,...r]);let h=(0,n.P1)([a],e=>e.selectedLanguage),m=(0,n.P1)([d,h],(e,r)=>e.filter(e=>e.languageCulture===r)),p=(0,n.P1)([u,h],(e,r)=>e.filter(e=>e.languageCulture===r)),f=(0,n.P1)([a],e=>e.loadingCourses);(0,n.P1)([a],e=>e.coursesError);let x=(0,n.P1)([a],e=>e.selectedCourse);(0,n.P1)([a],e=>e.coursePlans),(0,n.P1)([a],e=>e.loadingDetails),(0,n.P1)([a],e=>e.detailsError);let g=(0,n.P1)([a],e=>e.marathons);(0,n.P1)([a],e=>e.loadingMarathon),(0,n.P1)([a],e=>e.marathonError);let v=(0,n.P1)([l,g],(e,r)=>e.map(e=>{var t,n,a;let o=e.wpMarathonId||e.marathonId||e.id;return{...e,marathonId:o,marathon:r[o],progress:(null===(t=r[o])||void 0===t?void 0:t.progress)||0,completedDays:(null===(n=r[o])||void 0===n?void 0:n.completedDays)||0,totalDays:(null===(a=r[o])||void 0===a?void 0:a.totalDays)||e.days||0}}))},5689:function(e,r,t){"use strict";t.d(r,{LV:function(){return s},MK:function(){return c},P9:function(){return p},Rc:function(){return l},_R:function(){return o},ay:function(){return i},b0:function(){return u},cx:function(){return h},h6:function(){return m},hV:function(){return d}});var n=t(8697);let a=e=>e.dayReducer,o=(0,n.P1)(a,e=>e.currentDay),s=(0,n.P1)(a,e=>e.loading),l=(0,n.P1)(a,e=>e.error),i=(0,n.P1)(o,e=>(null==e?void 0:e.marathonDay)||null),c=(0,n.P1)(i,e=>(null==e?void 0:e.dayCategories)||[]),d=(0,n.P1)(a,e=>e.changingStatusRequests),u=(0,n.P1)(a,e=>e.updatedExercisesStatus);(0,n.P1)(a,e=>e.activeExerciseId);let h=(0,n.P1)(o,e=>(null==e?void 0:e.title)||""),m=(0,n.P1)(a,e=>e.marathonData),p=(0,n.P1)(a,e=>e.currentMarathon)},8697:function(e,r,t){"use strict";t.d(r,{P1:function(){return o}});var n="NOT_FOUND",a=function(e,r){return e===r},o=function(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return function(){for(var r,n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=0,l={memoizeOptions:void 0},i=a.pop();if("object"==typeof i&&(l=i,i=a.pop()),"function"!=typeof i)throw Error("createSelector expects an output function after the inputs, but received: ["+typeof i+"]");var c=l.memoizeOptions,d=void 0===c?t:c,u=Array.isArray(d)?d:[d],h=function(e){var r=Array.isArray(e[0])?e[0]:e;if(!r.every(function(e){return"function"==typeof e}))throw Error("createSelector expects all input-selectors to be functions, but received the following types: ["+r.map(function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e}).join(", ")+"]");return r}(a),m=e.apply(void 0,[function(){return s++,i.apply(null,arguments)}].concat(u)),p=e(function(){for(var e=[],t=h.length,n=0;n<t;n++)e.push(h[n].apply(null,arguments));return r=m.apply(null,e)});return Object.assign(p,{resultFunc:i,memoizedResultFunc:m,dependencies:h,lastResult:function(){return r},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),p}}(function(e,r){var t,o,s="object"==typeof r?r:{equalityCheck:r},l=s.equalityCheck,i=s.maxSize,c=void 0===i?1:i,d=s.resultEqualityCheck,u=(t=void 0===l?a:l,function(e,r){if(null===e||null===r||e.length!==r.length)return!1;for(var n=e.length,a=0;a<n;a++)if(!t(e[a],r[a]))return!1;return!0}),h=1===c?{get:function(e){return o&&u(o.key,e)?o.value:n},put:function(e,r){o={key:e,value:r}},getEntries:function(){return o?[o]:[]},clear:function(){o=void 0}}:function(e,r){var t=[];function a(e){var a=t.findIndex(function(t){return r(e,t.key)});if(a>-1){var o=t[a];return a>0&&(t.splice(a,1),t.unshift(o)),o.value}return n}return{get:a,put:function(r,o){a(r)===n&&(t.unshift({key:r,value:o}),t.length>e&&t.pop())},getEntries:function(){return t},clear:function(){t=[]}}}(c,u);function m(){var r=h.get(arguments);if(r===n){if(r=e.apply(null,arguments),d){var t=h.getEntries().find(function(e){return d(e.value,r)});t&&(r=t.value)}h.put(arguments,r)}return r}return m.clearCache=function(){return h.clear()},m})}},function(e){e.O(0,[675,888,774,179],function(){return e(e.s=6097)}),_N_E=e.O()}]);