(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{6097:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/courses/[courseId]/start",function(){return r(6381)}])},440:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(5893);r(7294);var s=r(1163),a=r(9133),o=r(5689);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?e>=200?5:e>=150?4:e>=100?3:e>=50?2:e>=1?1:0:e>=100?3:e>=50?2:e>=1?1:0},i=e=>{let{rating:t,maxStars:r=5}=e;return(0,n.jsx)("div",{className:"flex items-center justify-center space-x-0.5",children:Array.from({length:r}).map((e,r)=>{let s=r+1;return(0,n.jsx)("svg",{className:"w-3 h-3 ".concat(s<=t?"text-yellow-400 fill-current":"text-gray-300"),viewBox:"0 0 20 20",children:(0,n.jsx)("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"})},s)})})};function c(e){let{marathonId:t,currentDayId:r}=e,c=(0,s.useRouter)(),d=(0,a.C)(o.h6),u=(null==d?void 0:d.marathonDays)||[],h=(null==d?void 0:d.greatExtensionDays)||[];console.log("\uD83D\uDCCB DaysList - Current day ID:",r),console.log("\uD83D\uDCCB DaysList - Marathon days:",u.map(e=>({id:e.id,day:e.day,progress:e.progress}))),console.log("\uD83D\uDCCB DaysList - Practice days:",h.map(e=>({id:e.id,day:e.day,progress:e.progress})));let p=e=>{c.push("/courses/".concat(t,"/day/").concat(e))};return 0==[...u,...h].length?null:(0,n.jsxs)("div",{className:"mt-8 bg-white rounded-2xl shadow-lg p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Пройденные дни"}),(0,n.jsx)("button",{onClick:()=>c.push("/courses/".concat(t,"/start")),className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md hover:shadow-lg",children:"СТАРТ"})]}),u.length>0&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h4",{className:"text-sm font-semibold text-purple-600 mb-3",children:"Обучение"}),(0,n.jsx)("div",{className:"grid grid-cols-7 gap-2",children:u.map(e=>{let t=e.id===r,s=l(e.progress||0,!1);return(0,n.jsxs)("button",{onClick:()=>p(e.id),disabled:e.isLocked,className:"\n                    relative p-3 rounded-lg border-2 transition-all\n                    ".concat(t?"border-purple-500 bg-purple-50":e.isLocked?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-200 hover:border-purple-300 hover:shadow-md cursor-pointer","\n                  "),children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1 ".concat(t?"text-purple-700":"text-gray-600"),children:"День"}),(0,n.jsx)("div",{className:"text-lg font-bold ".concat(t?"text-purple-700":"text-gray-800"),children:e.day})]}),s>0&&(0,n.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:(0,n.jsx)(i,{rating:s,maxStars:3})}),e.isLocked&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})]},e.id)})})]}),h.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-semibold text-orange-600 mb-3",children:"Практика"}),(0,n.jsx)("div",{className:"grid grid-cols-7 gap-2",children:h.map(e=>{let t=e.id===r,s=l(e.progress||0,!0);return(0,n.jsxs)("button",{onClick:()=>p(e.id),disabled:e.isLocked,className:"\n                    relative p-3 rounded-lg border-2 transition-all\n                    ".concat(t?"border-orange-500 bg-orange-50":e.isLocked?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-200 hover:border-orange-300 hover:shadow-md cursor-pointer","\n                  "),children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1 ".concat(t?"text-orange-700":"text-gray-600"),children:"День"}),(0,n.jsx)("div",{className:"text-lg font-bold ".concat(t?"text-orange-700":"text-gray-800"),children:e.day})]}),s>0&&(0,n.jsx)("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:(0,n.jsx)(i,{rating:s,maxStars:5})}),e.isLocked&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})]},e.id)})})]})]})}},6381:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(5893),s=r(7294),a=r(1163),o=r(9133),l=r(5689),i=r(7796),c=r(7369),d=r(7526),u=r(440),h=r(5675),p=r.n(h);let m=e=>{let{htmlContent:t}=e,r=Array.from(new DOMParser().parseFromString(t,"text/html").querySelectorAll("li"));return 0===r.length?(0,n.jsx)("div",{className:"prose prose-purple max-w-none",dangerouslySetInnerHTML:{__html:t}}):(0,n.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,n.jsx)("div",{className:"p-4 rounded-lg ".concat(t%2==0?"bg-white":"bg-gray-50"),children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"text-purple-600 font-bold mr-3 mt-0.5",children:"•"}),(0,n.jsx)("div",{className:"flex-1 text-gray-700",dangerouslySetInnerHTML:{__html:e.innerHTML}})]})},t))})};function f(){var e,t,r,h,f;let x=(0,a.useRouter)(),{courseId:g}=x.query,v=(0,o.T)(),y=(0,o.C)(l.h6),b=(0,o.C)(i.sy),[j,N]=(0,s.useState)(!0),[w,k]=(0,s.useState)(!1),[C,D]=(0,s.useState)(!1),P=b.find(e=>e.id===g||e.wpMarathonId===g),L=(null==P?void 0:P.id)||g,I=(null==y?void 0:null===(e=y.welcomeMessage)||void 0===e?void 0:e.welcomeMessage)||"",E=(null==y?void 0:null===(t=y.rule)||void 0===t?void 0:t.rule)||(null==y?void 0:null===(h=y.marathonDays)||void 0===h?void 0:null===(r=h[0])||void 0===r?void 0:r.description)||"",_=(null==y?void 0:y.marathonDays)||[],M=_[_.length-1],S=y&&y.marathonId===L,A=S?y:null;(0,s.useEffect)(()=>{L&&!S&&(console.log("\uD83D\uDCDA Loading marathon data for order ID:",L),v((0,c.JL)({marathonId:L,dayId:"current"})))},[L,S,v]),(0,s.useEffect)(()=>{if(A){let e=!0===A.isAcceptCourseTerm;console.log("\uD83D\uDCCB Marathon data loaded, isAcceptCourseTerm:",e),k(e),L&&P&&e!==P.isAcceptCourseTerm&&v((0,d.eN)({courseId:L,status:e}))}},[A,L,P,v]);let R=async()=>{if(L&&!C){if(!w){alert("Пожалуйста, примите правила курса для продолжения.");return}try{D(!0);let e=null==M?void 0:M.id,t=(null==M?void 0:M.day)||1;e?(console.log("\uD83D\uDCCD Navigating to day",t,"with ID:",e),x.push("/courses/".concat(g,"/day/").concat(e))):(console.log('⚠️ No day ID found, navigating to "current"'),x.push("/courses/".concat(g,"/day/current")))}catch(e){console.error("❌ Failed to navigate:",e),alert("Произошла ошибка. Попробуйте еще раз.")}finally{D(!1)}}},T=async e=>{if(!C)try{D(!0),k(e),v((0,d.fp)({courseId:L,status:e})),console.log(e?"✅ Rules accepted":"❌ Rules rejected","for marathon:",L),await new Promise(e=>setTimeout(e,500))}catch(t){console.error("❌ Failed to update rules acceptance:",t),k(!e),alert("Не удалось сохранить изменения. Попробуйте еще раз.")}finally{D(!1)}};return P?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50",children:[(0,n.jsx)("header",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("button",{onClick:()=>x.push("/courses"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Назад",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),P.imagePath&&(0,n.jsx)("div",{className:"relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0 bg-white/10",children:(0,n.jsx)(p(),{src:P.imagePath,alt:P.title,fill:!0,className:"object-cover"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h1",{className:"text-lg font-bold",children:P.title}),P.subTitle&&(0,n.jsx)("p",{className:"text-sm text-white/80",children:P.subTitle})]})]})})}),(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[I&&(0,n.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:(0,n.jsx)("div",{className:"prose prose-purple max-w-none",dangerouslySetInnerHTML:{__html:I}})}),(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,n.jsxs)("button",{onClick:()=>N(!j),className:"w-full px-6 py-4 flex items-center justify-between bg-gradient-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 transition-colors",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-purple-900",children:"Правила курса"}),(0,n.jsx)("svg",{className:"w-6 h-6 text-purple-600 transition-transform ".concat(j?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j&&(0,n.jsxs)("div",{className:"p-6",children:[E?(0,n.jsx)(m,{htmlContent:E}):(0,n.jsxs)("div",{className:"text-gray-600 space-y-2",children:[(0,n.jsxs)("p",{className:"mb-4",children:["\uD83D\uDCCB ",(0,n.jsx)("strong",{children:"Основные правила:"})]}),["Выполняйте упражнения ежедневно в течение 14 дней","Следуйте видеоинструкциям для правильной техники","Делайте фото до/после для отслеживания прогресса","Отмечайте выполненные упражнения галочками","Набирайте звезды за качественное выполнение"].map((e,t)=>(0,n.jsx)("div",{className:"p-4 rounded-lg ".concat(t%2==0?"bg-white":"bg-gray-50"),children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("span",{className:"text-purple-600 font-bold mr-3",children:"•"}),(0,n.jsx)("span",{className:"flex-1",children:e})]})},t))]}),(0,n.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,n.jsxs)("label",{className:"flex items-start space-x-3 cursor-pointer",children:[(0,n.jsx)("input",{type:"checkbox",checked:w,onChange:e=>T(e.target.checked),disabled:C,className:"mt-1 w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500 disabled:opacity-50"}),(0,n.jsx)("span",{className:"text-gray-700",children:"Я ознакомился(ась) с правилами курса и принимаю условия"})]}),(0,n.jsx)("button",{onClick:R,disabled:!w||C,className:"\n                    mt-4 w-full py-3 px-6 rounded-lg font-semibold text-white transition-all\n                    ".concat(w&&!C?"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 shadow-lg":"bg-gray-300 cursor-not-allowed","\n                  "),children:C?"Отправка...":"Начать курс"})]})]})]}),L&&_.length>0&&(0,n.jsx)(u.Z,{marathonId:L,currentDayId:(null===(f=_[0])||void 0===f?void 0:f.id)||""})]})]}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-50 to-purple-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Загрузка курса..."})]})})}},7796:function(e,t,r){"use strict";r.d(t,{JB:function(){return m},Kh:function(){return h},LJ:function(){return p},aJ:function(){return c},gi:function(){return f},h3:function(){return v},ks:function(){return i},sy:function(){return o},z5:function(){return x}});var n=r(8697);let s=e=>e.courses,a=(0,n.P1)([s],e=>e.myOrders),o=a,l=(0,n.P1)([a],e=>e.filter(e=>"Approved"===e.orderStatus||"Active"===e.status||!0===e.isPurchased)),i=(0,n.P1)([s],e=>e.loadingOrders);(0,n.P1)([s],e=>e.ordersError);let c=(0,n.P1)([s],e=>e.activatingOrderId),d=(0,n.P1)([s],e=>e.availableCourses),u=(0,n.P1)([s],e=>e.demoCourses);(0,n.P1)([d,u],(e,t)=>[...e,...t]);let h=(0,n.P1)([s],e=>e.selectedLanguage),p=(0,n.P1)([d,h],(e,t)=>e.filter(e=>e.languageCulture===t)),m=(0,n.P1)([u,h],(e,t)=>e.filter(e=>e.languageCulture===t)),f=(0,n.P1)([s],e=>e.loadingCourses);(0,n.P1)([s],e=>e.coursesError);let x=(0,n.P1)([s],e=>e.selectedCourse);(0,n.P1)([s],e=>e.coursePlans),(0,n.P1)([s],e=>e.loadingDetails),(0,n.P1)([s],e=>e.detailsError);let g=(0,n.P1)([s],e=>e.marathons);(0,n.P1)([s],e=>e.loadingMarathon),(0,n.P1)([s],e=>e.marathonError);let v=(0,n.P1)([l,g],(e,t)=>e.map(e=>{var r,n,s;let a=e.wpMarathonId||e.marathonId||e.id;return{...e,marathonId:a,marathon:t[a],progress:(null===(r=t[a])||void 0===r?void 0:r.progress)||0,completedDays:(null===(n=t[a])||void 0===n?void 0:n.completedDays)||0,totalDays:(null===(s=t[a])||void 0===s?void 0:s.totalDays)||e.days||0}}))},5689:function(e,t,r){"use strict";r.d(t,{LV:function(){return o},MK:function(){return c},Rc:function(){return l},_R:function(){return a},ay:function(){return i},b0:function(){return u},cx:function(){return p},h6:function(){return m},hV:function(){return d},z6:function(){return h}});var n=r(8697);let s=e=>e.dayReducer,a=(0,n.P1)(s,e=>e.currentDay),o=(0,n.P1)(s,e=>e.loading),l=(0,n.P1)(s,e=>e.error),i=(0,n.P1)(a,e=>(null==e?void 0:e.marathonDay)||null),c=(0,n.P1)(i,e=>(null==e?void 0:e.dayCategories)||[]),d=(0,n.P1)(s,e=>e.changingStatusRequests),u=(0,n.P1)(s,e=>e.updatedExercisesStatus),h=(0,n.P1)(s,e=>e.activeExerciseId),p=(0,n.P1)(a,e=>(null==e?void 0:e.title)||""),m=(0,n.P1)(s,e=>e.marathonData)},8697:function(e,t,r){"use strict";r.d(t,{P1:function(){return a}});var n="NOT_FOUND",s=function(e,t){return e===t},a=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t,n=arguments.length,s=Array(n),a=0;a<n;a++)s[a]=arguments[a];var o=0,l={memoizeOptions:void 0},i=s.pop();if("object"==typeof i&&(l=i,i=s.pop()),"function"!=typeof i)throw Error("createSelector expects an output function after the inputs, but received: ["+typeof i+"]");var c=l.memoizeOptions,d=void 0===c?r:c,u=Array.isArray(d)?d:[d],h=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e}))throw Error("createSelector expects all input-selectors to be functions, but received the following types: ["+t.map(function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e}).join(", ")+"]");return t}(s),p=e.apply(void 0,[function(){return o++,i.apply(null,arguments)}].concat(u)),m=e(function(){for(var e=[],r=h.length,n=0;n<r;n++)e.push(h[n].apply(null,arguments));return t=p.apply(null,e)});return Object.assign(m,{resultFunc:i,memoizedResultFunc:p,dependencies:h,lastResult:function(){return t},recomputations:function(){return o},resetRecomputations:function(){return o=0}}),m}}(function(e,t){var r,a,o="object"==typeof t?t:{equalityCheck:t},l=o.equalityCheck,i=o.maxSize,c=void 0===i?1:i,d=o.resultEqualityCheck,u=(r=void 0===l?s:l,function(e,t){if(null===e||null===t||e.length!==t.length)return!1;for(var n=e.length,s=0;s<n;s++)if(!r(e[s],t[s]))return!1;return!0}),h=1===c?{get:function(e){return a&&u(a.key,e)?a.value:n},put:function(e,t){a={key:e,value:t}},getEntries:function(){return a?[a]:[]},clear:function(){a=void 0}}:function(e,t){var r=[];function s(e){var s=r.findIndex(function(r){return t(e,r.key)});if(s>-1){var a=r[s];return s>0&&(r.splice(s,1),r.unshift(a)),a.value}return n}return{get:s,put:function(t,a){s(t)===n&&(r.unshift({key:t,value:a}),r.length>e&&r.pop())},getEntries:function(){return r},clear:function(){r=[]}}}(c,u);function p(){var t=h.get(arguments);if(t===n){if(t=e.apply(null,arguments),d){var r=h.getEntries().find(function(e){return d(e.value,t)});r&&(t=r.value)}h.put(arguments,t)}return t}return p.clearCache=function(){return h.clear()},p})}},function(e){e.O(0,[675,888,774,179],function(){return e(e.s=6097)}),_N_E=e.O()}]);