(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{528:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(6401)}])},6401:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(7294),l=t(1163),n=t(9133),i=t(3031),c=t(803),d=t(8256),o=t(7963),x=t(74);let m=e=>{let s=e.metadata;return s?"premium"===s.type||"premium"===s.planType?"Покупка: Премиум доступ":"marathon"===s.type&&s.marathonName?"Покупка: ".concat(s.marathonName):"exercise"===s.type&&s.exerciseName?"Покупка: ".concat(s.exerciseName):"Покупка":"Покупка"};s.default=()=>{let e=(0,l.useRouter)(),s=(0,n.T)(),{user:t,isAuthenticated:u}=(0,n.C)(e=>e.auth),[p,h]=(0,r.useState)([]),[g,b]=(0,r.useState)([]);return((0,r.useEffect)(()=>{u||e.push("/auth/login")},[u,e]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=await c.WY.get(d.fI);e.payments&&h(e.payments.slice(0,5))}catch(e){console.error("Failed to load payments:",e)}},s=async()=>{try{let e=localStorage.getItem("auth_token");if(!e)return;let s=await fetch("".concat("https://api-rejuvena.duckdns.org","/api/marathons"),{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();if(e.success&&e.marathons){let s=e.marathons.filter(e=>e.userEnrolled);b(s)}}}catch(e){console.error("Failed to load marathons:",e)}};u&&(console.log("\uD83D\uDD0D Dashboard user data:",{isPremium:null==t?void 0:t.isPremium,premiumEndDate:null==t?void 0:t.premiumEndDate,premiumEndDateType:typeof(null==t?void 0:t.premiumEndDate),fullUser:t}),e(),s())},[u,t]),u)?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Личный кабинет"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(o.Z,{}),(0,a.jsx)("button",{onClick:()=>{u&&(s((0,i.kS)()),c.VH.remove()),e.push("/auth/login")},className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:u?"Выйти":"Войти"})]})]})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:["Добро пожаловать, ",(null==t?void 0:t.firstName)||"Гость","!"]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Email: ",(null==t?void 0:t.email)||"Не указан"]})]}),(null==t?void 0:t.isPremium)&&(0,a.jsx)("div",{className:"mb-6 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg shadow-lg p-6 text-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-2",children:"✨ Премиум доступ активен"}),(0,a.jsxs)("p",{className:"text-purple-100",children:["Активен до: ",(null==t?void 0:t.premiumEndDate)?new Date(t.premiumEndDate).toLocaleDateString("ru-RU"):"неизвестно"]}),(null==t?void 0:t.premiumEndDate)&&(0,a.jsxs)("p",{className:"text-purple-100 mt-1",children:["Осталось дней: ",Math.max(0,Math.ceil((new Date(t.premiumEndDate).getTime()-new Date().getTime())/864e5))]}),(0,a.jsx)("p",{className:"text-purple-100 mt-1",children:"\uD83C\uDFAF Разблокирован доступ ко всем упражнениям"})]}),(0,a.jsx)("div",{className:"text-6xl",children:"\uD83D\uDC51"})]})}),g.length>0&&(0,a.jsx)("div",{className:"mb-6 space-y-4",children:g.map(s=>(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg shadow-lg p-6 text-white cursor-pointer hover:shadow-xl transition-shadow",onClick:()=>e.push("/marathons/".concat(s._id,"/start")),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold",children:["\uD83C\uDFAF ",s.title]}),(0,a.jsx)("span",{className:"text-xs bg-white/20 px-2 py-1 rounded",children:"Оплачено"})]}),s.description&&(0,a.jsx)("p",{className:"text-blue-100 mb-2",children:s.description}),(0,a.jsxs)("p",{className:"text-blue-100",children:["\uD83D\uDCC5 Длительность: ",s.numberOfDays," дней"]})]}),(0,a.jsx)("button",{className:"ml-4 bg-white text-blue-600 font-semibold px-6 py-3 rounded-lg hover:bg-blue-50 transition-colors flex-shrink-0",children:"Перейти в марафон →"})]})},s._id))}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(x.Z,{})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/courses"),children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCDA"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Мои курсы"})]}),(0,a.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/exercises"),children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83C\uDFCB️"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Упражнения"})]}),(0,a.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/photo-diary"),children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCF8"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Фото-дневник"})]}),(0,a.jsxs)("button",{className:"flex items-center space-x-3 p-4 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors text-left group border border-purple-200",onClick:()=>e.push("/profile/settings"),children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDC64"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-800 group-hover:text-purple-600",children:"Профиль"})]})]})}),u&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Последняя активность"}),0===p.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-gray-400 text-5xl mb-2",children:"\uD83D\uDCED"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Активности пока нет"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Начните с выбора курса!"})]}):(0,a.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:"succeeded"===e.status?"✅":"processing"===e.status?"⏳":"failed"===e.status?"❌":"⏸️"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:"succeeded"===e.status?"Оплата принята":"processing"===e.status?"Обработка оплаты":"failed"===e.status?"Оплата не прошла":"Ожидание оплаты"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:m(e)})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-bold text-gray-800",children:[e.amount," ₽"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("ru-RU")})]})]},e.id))})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})})}}},function(e){e.O(0,[692,471,888,774,179],function(){return e(e.s=528)}),_N_E=e.O()}]);