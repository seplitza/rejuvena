(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{8101:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/exercises",function(){return r(3102)}])},3102:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var s=r(5893),i=r(7294),l=r(1163),a=r(9133),n=r(3224),o=r(4675),c=r(1807),d=r(4100),x=r(5871);function p(){let e=(0,l.useRouter)(),{user:t}=(0,a.C)(e=>e.auth),[r,p]=(0,i.useState)([]),[u,h]=(0,i.useState)(!0),[g,m]=(0,i.useState)(null),[b,w]=(0,i.useState)({}),[f,v]=(0,i.useState)({}),[j,N]=(0,i.useState)(null),[y,k]=(0,i.useState)(!1),[C,S]=(0,i.useState)(null),[_,E]=(0,i.useState)(!1),[T,F]=(0,i.useState)("all");(0,i.useEffect)(()=>{E(!0)},[]),(0,i.useEffect)(()=>{(async()=>{try{h(!0);let e=await fetch("".concat(x.T,"/api/exercises/public"));if(!e.ok)throw Error("Failed to load exercises: ".concat(e.statusText));let t=(await e.json()).map(e=>({id:e._id,exerciseName:e.title,marathonExerciseName:e.duration||"",exerciseDescription:e.content||e.description||"",blockExercise:!1,order:e.order,exerciseContents:e.carouselMedia.map(e=>({id:e.url,type:e.type,contentPath:e.url,order:e.order,isActive:!0,videoServer:""})),tags:e.tags.map(e=>e.name),category:e.category||"Общие"}));p(t),m(null)}catch(e){console.error("Error loading exercises:",e),m(e instanceof Error?e.message:"Failed to load exercises")}finally{h(!1)}})()},[]);let O=e=>{w(t=>({...t,[e]:!t[e]}))},D=(e,t)=>{v(e=>({...e,[t]:!e[t]}))},P=e=>{let r=(0,d.Sw)(e.tags||[]),s=(0,d.qI)(e.id,null==t?void 0:t.isPremium);r.isFree||s?N(e):(S(e),k(!0))},q=()=>{k(!1),S(null)},z=e=>{let t=(0,d.Sw)(e.tags||[]);return t.isFree?1:"basic"===t.priceType?2:"pro"===t.priceType?3:4},B=[...r].sort((e,t)=>{let r=z(e),s=z(t);return r!==s?r-s:e.order-t.order}),I=B.reduce((e,t)=>{let r=t.category||"Общие";return e[r]||(e[r]=[]),e[r].push(t),e},{}),L=Object.keys(I),M="all"===T?B:I[T]||[];return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50",children:[(0,s.jsx)("header",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-3 py-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors flex-shrink-0","aria-label":"Назад",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsx)("h1",{className:"text-xl font-bold flex-1 text-center",children:"Все упражнения"}),(0,s.jsx)("div",{className:"w-10"})]})})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:u?(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Загрузка упражнений..."})]}):g?(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"text-red-500 text-5xl mb-4",children:"⚠️"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Ошибка загрузки"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:g}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Попробовать снова"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 bg-white rounded-2xl shadow-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[(0,s.jsxs)("button",{onClick:()=>F("all"),className:"px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors ".concat("all"===T?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Все (",B.length,")"]}),L.map(e=>(0,s.jsxs)("button",{onClick:()=>F(e),className:"px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors ".concat(T===e?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e," (",I[e].length,")"]},e))]})}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-4",children:(0,s.jsx)("h2",{className:"text-xl font-bold",children:"all"===T?"Все упражнения (".concat(B.length,")"):"".concat(T," (").concat(M.length,")")})}),(0,s.jsx)("div",{className:"px-0 sm:px-6 pb-4 space-y-2",children:0===M.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Упражнения не найдены"}):M.map((e,r)=>{let i="exercise-".concat(e.id||r),l=b[i]||!1,a=f[i]||!1,o=(0,d.Sw)(e.tags||[]),x=(0,d.qI)(e.id,null==t?void 0:t.isPremium),p=!o.isFree&&!x,u=(0,d.ns)(o);return(0,s.jsxs)("div",{className:"relative",children:[u&&(0,s.jsx)("div",{className:"px-4 pt-3 pb-0",children:(0,s.jsx)("span",{className:"inline-block text-xs font-bold px-3 py-1 rounded-full ".concat(o.isFree?"bg-green-100 text-green-700":"pro"===o.priceType?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"),children:u})}),(0,s.jsx)(n.Z,{exercise:e,uniqueId:i,isActive:l,isDone:a,isChanging:!1,onToggle:()=>O(i),onCheck:()=>D(e,i),onDetailClick:()=>P(e)}),e.exerciseDescription&&(0,s.jsx)("div",{className:"px-4 pb-3 text-sm text-gray-600 whitespace-pre-line",style:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!e)return"";let r=e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").trim().split("\n").filter(e=>e.trim()).slice(0,t).join("\n"),s=50*t;return r.length>s?r.substring(0,s).trim()+"...":r}(e.exerciseDescription,4)}),p&&(0,s.jsx)("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-2",children:(0,s.jsx)("div",{className:"bg-white rounded-full p-2 shadow-lg",children:(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})}),_&&C&&(0,s.jsx)(c.Z,{isOpen:y,onClose:q,price:(0,d.Sw)(C.tags||[]).price,exerciseName:C.exerciseName,isPro:"pro"===(0,d.Sw)(C.tags||[]).priceType})]},e.id||r)})})]})]})}),_&&j&&(0,s.jsx)(o.Z,{exercise:j,isOpen:!!j,onClose:()=>N(null),onCheckboxChange:()=>{let e="exercise-".concat(j.id);D(j,e)},isDone:f["exercise-".concat(j.id)]||!1})]})}}},function(e){e.O(0,[675,441,593,888,774,179],function(){return e(e.s=8101)}),_N_E=e.O()}]);