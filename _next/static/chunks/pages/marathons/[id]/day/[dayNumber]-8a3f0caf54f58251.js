(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[282],{4869:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/marathons/[id]/day/[dayNumber]",function(){return n(9090)}])},5871:function(e,t,n){"use strict";n.d(t,{P:function(){return o},T:function(){return i}});let i="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:9527":"https://api-rejuvena.duckdns.org",o={exercises:{public:"".concat(i,"/api/exercises/public"),byId:e=>"".concat(i,"/api/exercises/").concat(e)},courses:{public:"".concat(i,"/api/courses/public"),byId:e=>"".concat(i,"/api/courses/").concat(e)},payment:{create:"".concat(i,"/api/payment/create"),status:e=>"".concat(i,"/api/payment/status/").concat(e)}}},9090:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n(5893),o=n(7294),r=n(1163),s=n(9133),a=n(5871);function c(){let e=(0,r.useRouter)(),{id:t,dayNumber:n}=e.query,{isAuthenticated:c}=(0,s.C)(e=>e.auth),[d,l]=(0,o.useState)(null),[p,x]=(0,o.useState)(!0),[h,u]=(0,o.useState)(null),[g,y]=(0,o.useState)(new Set),[f,m]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&n&&b()},[t,n]);let b=async()=>{try{x(!0);let e=localStorage.getItem("auth_token"),i=await fetch("".concat(a.T,"/api/marathons/").concat(t,"/day/").concat(n),{headers:e?{Authorization:"Bearer ".concat(e)}:{}});if(!i.ok){let e=await i.json();throw Error(e.message||"Не удалось загрузить день")}let o=await i.json();l(o),u(null)}catch(e){console.error("Error loading day:",e),u(e instanceof Error?e.message:"Ошибка загрузки дня")}finally{x(!1)}},j=async()=>{if(!c){alert("Войдите для отметки прогресса");return}try{m(!0);let i=localStorage.getItem("auth_token"),o=await fetch("".concat(a.T,"/api/marathons/").concat(t,"/complete-day"),{method:"POST",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({dayNumber:Number(n)})});if(!o.ok){let e=await o.json();throw Error(e.message||"Не удалось отметить день")}alert("✅ День завершён! Отличная работа!"),e.push("/marathons/".concat(t))}catch(e){console.error("Error completing day:",e),alert(e instanceof Error?e.message:"Ошибка при завершении дня")}finally{m(!1)}},w=e=>{let t=new Set(g);t.has(e)?t.delete(e):t.add(e),y(t)},S=(null==d?void 0:d.exercises.every(e=>g.has(e._id)))||!1;return p?(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center"},children:(0,i.jsx)("div",{style:{fontSize:"18px",color:"#6B7280"},children:"Загрузка дня..."})}):h||!d?(0,i.jsxs)("div",{style:{padding:"40px",textAlign:"center"},children:[(0,i.jsxs)("div",{style:{fontSize:"18px",color:"#DC2626",marginBottom:"16px"},children:["❌ ",h||"День не найден"]}),(0,i.jsx)("button",{onClick:()=>e.push("/marathons/".concat(t)),style:{padding:"10px 20px",background:"#4F46E5",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"500"},children:"Вернуться к марафону"})]}):(0,i.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"40px 20px"},children:[(0,i.jsx)("button",{onClick:()=>e.push("/marathons/".concat(t)),style:{padding:"8px 16px",background:"#F3F4F6",color:"#374151",border:"none",borderRadius:"8px",cursor:"pointer",marginBottom:"24px",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"500"},children:"← Вернуться к марафону"}),(0,i.jsx)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"16px",padding:"40px",color:"white",marginBottom:"32px"},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h1",{style:{fontSize:"36px",fontWeight:"bold",marginBottom:"12px"},children:["День ",d.dayNumber]}),(0,i.jsx)("div",{style:{fontSize:"18px",opacity:.95,marginBottom:"16px"},children:"learning"===d.dayType?"\uD83D\uDCDA Обучающий день":"\uD83C\uDFCB️ День практики"}),d.description&&(0,i.jsx)("p",{style:{fontSize:"16px",opacity:.9,margin:0,maxWidth:"600px"},children:d.description})]}),(0,i.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.2)",padding:"16px 24px",borderRadius:"12px",textAlign:"center"},children:[(0,i.jsxs)("div",{style:{fontSize:"32px",fontWeight:"bold",marginBottom:"4px"},children:[g.size,"/",d.exercises.length]}),(0,i.jsx)("div",{style:{fontSize:"13px",opacity:.9},children:"упражнений выполнено"})]})]})}),(0,i.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,i.jsx)("h2",{style:{fontSize:"24px",fontWeight:"600",marginBottom:"24px",color:"#111827"},children:"Упражнения дня"}),0===d.exercises.length?(0,i.jsx)("div",{style:{padding:"60px",textAlign:"center",background:"#F9FAFB",borderRadius:"12px",color:"#6B7280"},children:"В этом дне пока нет упражнений"}):(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:d.exercises.map((e,t)=>(0,i.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:g.has(e._id)?"2px solid #10B981":"1px solid #E5E7EB",position:"relative"},children:[(0,i.jsx)("div",{style:{position:"absolute",top:"24px",right:"24px"},children:(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[(0,i.jsx)("input",{type:"checkbox",checked:g.has(e._id),onChange:()=>w(e._id),style:{width:"20px",height:"20px",cursor:"pointer",accentColor:"#10B981"}}),(0,i.jsx)("span",{style:{fontSize:"14px",color:"#6B7280",fontWeight:"500"},children:"Выполнено"})]})}),(0,i.jsxs)("div",{style:{display:"inline-block",background:"#EEF2FF",color:"#4F46E5",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",marginBottom:"12px"},children:["Упражнение ",t+1]}),(0,i.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",color:"#111827",marginBottom:"12px",paddingRight:"120px"},children:e.title}),e.description&&(0,i.jsxs)("p",{style:{fontSize:"15px",color:"#6B7280",lineHeight:"1.6",marginBottom:"16px"},children:[e.description.substring(0,200),e.description.length>200&&"..."]}),e.tags&&e.tags.length>0&&(0,i.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"16px",flexWrap:"wrap"},children:e.tags.map(e=>(0,i.jsx)("span",{style:{padding:"4px 10px",background:e.color||"#EEF2FF",color:"#4F46E5",borderRadius:"12px",fontSize:"12px",fontWeight:"500"},children:e.name},e._id))})]},e._id))})]}),d.exercises.length>0&&(0,i.jsxs)("div",{style:{position:"sticky",bottom:"20px",padding:"24px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",border:"1px solid #E5E7EB",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",color:"#111827",marginBottom:"4px"},children:S?"✅ Все упражнения выполнены!":"\uD83D\uDCDD Отметьте все упражнения как выполненные"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#6B7280"},children:["Прогресс: ",g.size," из ",d.exercises.length]})]}),(0,i.jsx)("button",{onClick:j,disabled:!S||f,style:{padding:"12px 32px",background:S&&!f?"#10B981":"#D1D5DB",color:"white",border:"none",borderRadius:"10px",cursor:S&&!f?"pointer":"not-allowed",fontWeight:"600",fontSize:"16px",boxShadow:S?"0 2px 4px rgba(16, 185, 129, 0.2)":"none"},children:f?"Сохранение...":"Завершить день"})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=4869)}),_N_E=e.O()}]);