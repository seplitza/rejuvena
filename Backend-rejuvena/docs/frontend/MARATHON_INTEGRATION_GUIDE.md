# Marathon Frontend Integration Guide

## –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã

### –°—Ç—Ä–∞–Ω–∏—Ü—ã (–≤ `/web/src/pages/`):

1. **`marathons.tsx`** - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞—Ä–∞—Ñ–æ–Ω–æ–≤
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞—Ä–∞—Ñ–æ–Ω—ã —Å —Ñ–ª–∞–≥–æ–º `isDisplay = true`
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É (upcoming/active/finished)
   - –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π: –¥–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞, —Ü–µ–Ω–∞, —É—á–∞—Å—Ç–Ω–∏–∫–∏, –ø—Ä–æ–≥—Ä–µ—Å—Å
   - –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **`marathons/[id].tsx`** - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞—Ä–∞—Ñ–æ–Ω–∞
   - 3 –≤–∫–ª–∞–¥–∫–∏: –û–ø–∏—Å–∞–Ω–∏–µ, –ü—Ä–æ–≥—Ä–∞–º–º–∞, –ü—Ä–∞–≤–∏–ª–∞
   - Hero —Å –¥–∞—Ç–æ–π —Å—Ç–∞—Ä—Ç–∞ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
   - –°–ø–∏—Å–æ–∫ –¥–Ω–µ–π —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö
   - –ö–Ω–æ–ø–∫–∞ –∑–∞–ø–∏—Å–∏ / –æ–ø–ª–∞—Ç—ã
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PaymentModal

3. **`marathons/[id]/day/[dayNumber].tsx`** - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–Ω—è –º–∞—Ä–∞—Ñ–æ–Ω–∞
   - –°–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–Ω—è
   - –ß–µ–∫–±–æ–∫—Å—ã –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
   - –ö–Ω–æ–ø–∫–∞ "–ó–∞–≤–µ—Ä—à–∏—Ç—å –¥–µ–Ω—å" (–∞–∫—Ç–∏–≤–Ω–∞ –∫–æ–≥–¥–∞ –≤—Å–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –æ—Ç–º–µ—á–µ–Ω—ã)
   - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

4. **`components/PaymentModalUpdated.tsx`** - –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π PaymentModal
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 3 —Ç–∏–ø–æ–≤: 'premium', 'exercise', 'marathon'
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ API
   - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UI

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Next.js –ø—Ä–æ–µ–∫—Ç

### –®–∞–≥ 1: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã

```bash
# –í –ø–∞–ø–∫–µ /Users/alexeipinaev/Documents/Rejuvena/web/
cp /Users/alexeipinaev/Documents/Rejuvena/Backend-rejuvena/docs/frontend/pages/marathons.tsx src/pages/
cp /Users/alexeipinaev/Documents/Rejuvena/Backend-rejuvena/docs/frontend/pages/marathon-detail.tsx src/pages/marathons/[id].tsx
cp /Users/alexeipinaev/Documents/Rejuvena/Backend-rejuvena/docs/frontend/pages/marathon-day.tsx src/pages/marathons/[id]/day/[dayNumber].tsx
cp /Users/alexeipinaev/Documents/Rejuvena/Backend-rejuvena/docs/frontend/components/PaymentModalUpdated.tsx src/components/PaymentModal.tsx
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫

```bash
mkdir -p src/pages/marathons/[id]/day
```

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

–í –≥–ª–∞–≤–Ω–æ–º –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å:

```tsx
<Link href="/marathons">
  <a className="nav-link">üèÉ –ú–∞—Ä–∞—Ñ–æ–Ω—ã</a>
</Link>
```

### –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –≤ Next.js

–§–∞–π–ª—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏:
- `/marathons` ‚Üí `pages/marathons.tsx`
- `/marathons/:id` ‚Üí `pages/marathons/[id].tsx`
- `/marathons/:id/day/:dayNumber` ‚Üí `pages/marathons/[id]/day/[dayNumber].tsx`

Next.js –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —ç—Ç–∏ –º–∞—Ä—à—Ä—É—Ç—ã.

## API Endpoints –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ

### –ü—É–±–ª–∏—á–Ω—ã–µ:
- `GET /api/marathons` - –°–ø–∏—Å–æ–∫ –º–∞—Ä–∞—Ñ–æ–Ω–æ–≤
- `GET /api/marathons/:id` - –î–µ—Ç–∞–ª–∏ –º–∞—Ä–∞—Ñ–æ–Ω–∞
- `GET /api/marathons/:id/days` - –í—Å–µ –¥–Ω–∏ –º–∞—Ä–∞—Ñ–æ–Ω–∞

### –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç JWT):
- `GET /api/marathons/:id/day/:dayNumber` - –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–Ω—è (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–æ—Å—Ç—É–ø–∞)
- `GET /api/marathons/:id/progress` - –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/marathons/:id/enroll` - –ó–∞–ø–∏—Å—å –Ω–∞ –º–∞—Ä–∞—Ñ–æ–Ω (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
- `POST /api/marathons/:id/complete-day` - –û—Ç–º–µ—Ç–∏—Ç—å –¥–µ–Ω—å –∫–∞–∫ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π

### –û–ø–ª–∞—Ç–∞:
- `POST /api/payment/create-marathon` - –°–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂ –¥–ª—è –º–∞—Ä–∞—Ñ–æ–Ω–∞

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. Access Control –Ω–∞ –¥–Ω–µ
–ë—ç–∫–µ–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `startDate`:
```typescript
const daysSinceStart = Math.floor((now - startDate) / (1000*60*60*24));
const currentAvailableDay = daysSinceStart + 1;

if (dayNumber > currentAvailableDay) {
  return 403; // "–≠—Ç–æ—Ç –¥–µ–Ω—å –µ—â—ë –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω"
}
```

### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Redux
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
```typescript
await loadEnrollment(); // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏
```

### 3. –£—Å–ª–æ–≤–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí "–í–æ–π–¥–∏—Ç–µ —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å—Å—è"
- –ï—Å–ª–∏ –º–∞—Ä–∞—Ñ–æ–Ω –ø–ª–∞—Ç–Ω—ã–π –∏ –Ω–µ –æ–ø–ª–∞—á–µ–Ω ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å PaymentModal
- –ï—Å–ª–∏ –º–∞—Ä–∞—Ñ–æ–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π ‚Üí —Å—Ä–∞–∑—É –∑–∞–ø–∏—Å–∞—Ç—å —á–µ—Ä–µ–∑ `/enroll`
- –ï—Å–ª–∏ –¥–µ–Ω—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–º–æ–∫ üîí

## –°—Ç–∏–ª–∏

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è inline styles –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:
- Tailwind CSS –∫–ª–∞—Å—Å—ã
- CSS Modules
- Styled Components

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Tailwind:
```tsx
// –ë—ã–ª–æ:
<div style={{ padding: '20px', background: 'white', borderRadius: '8px' }}>

// –°—Ç–∞–ª–æ:
<div className="p-5 bg-white rounded-lg">
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥: `cd Backend-rejuvena && npm run dev`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥: `cd web && npm run dev`
3. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ http://localhost:3000/marathons

### –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:
1. Deploy –±—ç–∫–µ–Ω–¥–∞ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ —á–µ—Ä–µ–∑ GitHub Actions)
2. Build —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞: `npm run build`
3. Deploy –Ω–∞ GitHub Pages: `npx gh-pages -d out`

## Checklist –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å 4 —Ñ–∞–π–ª–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞–ø–∫–∏
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–ú–∞—Ä–∞—Ñ–æ–Ω—ã" –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –º–∞—Ä–∞—Ñ–æ–Ω–æ–≤
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–Ω—è
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–Ω—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
- [ ] Deploy –Ω–∞ production

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –î–æ–±–∞–≤–∏—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ –Ω–æ–≤–æ–≥–æ –¥–Ω—è
2. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–∞—Ä–∞—Ñ–æ–Ω—É
3. **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**: –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
4. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏**: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –¥–Ω—è–º/—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º
5. **–§–æ—Ç–æ –¥–Ω–µ–≤–Ω–∏–∫**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–æ—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
6. **–ö–æ–Ω–∫—É—Ä—Å**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: 403 –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –¥–Ω—é
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–∏—Å–∞–Ω –Ω–∞ –º–∞—Ä–∞—Ñ–æ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–µ–Ω—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ JWT —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è PaymentModal
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `productType="marathon"`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω `productId` (marathonId)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ localStorage

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å
- –í—ã–∑–≤–∞—Ç—å `loadEnrollment()` –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å—Ç–∞—Ç—É—Å enrollment = 'active'
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–µ–Ω—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω –≤ –ë–î
